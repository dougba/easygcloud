function HydrogenPack(e,t){var n=angular.element("body"),o=parent.angular.element("body"),a=angular.element("#ct-builder"),i=hydrogen.get("domTreeVersion"),c=e.component.active,r=n.hasClass("ct_connection_active"),s={clipboard:"",canSaveReusable:!1,canSaveBlock:!1,canReadClipboard:!1,canWrapLink:!1,checkComponent:x,executeCommand:E,getComponentObject:v,refreshStatus:function(t){var n=c.id,o=c.name,a=c.parent,i=v(n),d=hydrogen.get("options.original.globalconditions",null,i);s.hasConditions=d&&d.length>0,s.canSaveReusable=e.isCanComponentize(n,o),s.canSaveBlock=r&&["ct_section","ct_div_block"].includes(o),s.canWrapLink=S(o,a.name),s.isTextComponent=["ct_text_block","oxy_rich_text"].includes(o),s.isTextComponent?s.convertTextLabel="ct_text_block"==o?"rich text":"text block":s.convertTextLabel="",s.canReadClipboard&&t.clipboard.readText().then((function(t){t&&/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(t)&&(s.clipboard=t,b(e))})),b(e)},showNotice:f};e.$watch("component.active",(function(){c=e.component.active}));var d=["savePage","switchCodeBlockTabs"],l=["cut","moveUp","moveDown","rename","changeId","showConditions","duplicate","saveReusable","saveBlock","wrap","delete","editContent"],p=["ct_id","ct_parent","ct_content","source_id","nicename","selector","activeselector","oxy_builtin"],u=["href","url","target","globalConditionsResult","globalconditions","code-php","code-css","code-js","full_shortcode","wrapping_shortcode","embed_src","use-custom","custom-code","src","image_type","attachment_height","attachment_id","attachment_size","attachment_url","attachment_width","icon-id","icon-facebook","icon-instagram","icon-linkedin","icon-rss","icon-twitter","icon-youtube","icon_box_heading","icon_box_text","gallery_source","image_ids","acf_field","metabox_field","woo_product_id","menu_id","pricing_box_content","pricing_box_package_regular","pricing_box_package_subtitle","pricing_box_package_title","pricing_box_price_amount_currency","pricing_box_price_amount_decimal","pricing_box_price_amount_main","pricing_box_price_amount_term","progress_bar_left_text","progress_bar_progress","progress_bar_progress-unit","progress_bar_right_text","testimonial_author","testimonial_author_info","testimonial_photo","testimonial_text","toggle_target","close_automatically","close_modal_on_backdrop_click","close_on_esc","number_of_clicks","open_again","trigger","map_address","map_zoom","soundcloud_auto_play","soundcloud_hide_related","soundcloud_track_id","soundcloud_url"];function g(e){return parent.angular.element(e)}function h(e){try{var t=JSON.stringify(e,(function(e,t){if("string"!=typeof e||0!==e.indexOf("$$"))return t}));return btoa(unescape(encodeURIComponent(t)))}catch(e){console.error(e)}return""}function b(e){return!e.$$phase&&(e.$digest(),!0)}function m(){var e=parent.currentCMEditor;e&&e.contentDOM&&e.contentDOM.blur()}function f(t){setTimeout((function(){e.showNoticeModal("<div>"+t+"</div>"),b(e)}),100)}function y(){var t=e.getActiveComponent();t.length&&(t.addClass("hydrogen-flash"),setTimeout((function(){t.removeClass("hydrogen-flash")}),1100))}function v(t){var n=null;return function e(o){void 0!==o.id&&o.id==t?n=o:o.children&&o.children.forEach(e)}(e.componentsTree),n}function k(t){var n={};function o(t){var a=t.id;e.componentsClasses.hasOwnProperty(a)&&e.componentsClasses[a].forEach((function(t){n.hasOwnProperty(t)||e.classes.hasOwnProperty(t)&&(n[t]=e.classes[t])})),t.children&&t.children.forEach(o)}return t.constructor==Array?t.forEach(o):o(t),n}function C(t,n){var o={};function a(t){for(key in t)if(t.hasOwnProperty(key)){var n=t[key];if("string"==typeof n){var i=n.match(/color\((\d+)\)/);if(i){var c=i[1];if(o.hasOwnProperty(c))return;var r=e.getGlobalColor(c);r&&(o[c]=_.pick(r,"id","name","value"))}}"object"==typeof n&&a(n)}}return a(t),a(n),o}function w(t,n){for(key in"object"!=typeof e.styleFolders[n]&&(e.styleFolders[n]={status:1,key:n}),t)t[key].parent=n;e.classes=Object.assign(t,e.classes),e.classesCached=!1}function T(t,n,o,a){var i={},c=e.globalColorSets,r=_.findWhere(c.sets,{name:a});function s(e,t){return"color("+(i[t]||t)+")"}function d(e){_.each(e,(function(t,n){var o=/color\((\d*)\)/g;"string"==typeof t&&o.test(t)?e[n]=t.replace(o,s):"object"==typeof t&&d(e[n])}))}return"object"!=typeof r&&(r={id:++c.setsIncrement,name:a},c.sets.push(r)),_.each(t,(function(e){var t=_.findWhere(c.colors,{name:e.name,set:r.id});"object"!=typeof t&&(t={id:++c.colorsIncrement,name:e.name,value:e.value,set:r.id},c.colors.push(t)),i[e.id]=t.id})),d(n),d(o),i}function x(){return!t.isActiveActionTab("contentEditing")&&(c.id>1e5?-1:c.id>0||0)}function S(e,t){return 0==["ct_link","ct_link_button","ct_link_text","ct_widget","ct_shortcode","ct_code_block"].includes(e)&&"oxy_dynamic_list"!==t}function E(){var n=_.values(arguments),o=n.shift(),a=x();if(!1===a&&!d.includes(o))return!1;if(!0!==a&&l.includes(o))return!1;var r=!0,A=c.id,M=c.name,P=c.parent;switch(o){case"copy":if(r=!1,hydrogen.get("settings.clipboard.enabled")){var j=[];if(A>0&&A<1e5?j.push(v(A)):j=function(){var t=[];return function e(n){n.forEach((function(n){n.id<1e5?t.push(n):n.children&&e(n.children)}))}(e.componentsTree.children),t}(),j.length){var I=C(j,U=k(j));(D=h(R={source:hydrogen.get("siteUrl"),component:j,classes:U,colors:I}))&&(hydrogen.get("settings.clipboard.flashCopiedComponent")&&y(),O(D),r=D)}r||f("Can not copy the element to clipboard")}break;case"copyStyle":r=!1,hydrogen.get("settings.clipboard.enabled")&&((F=v(A))&&(I=C($=angular.copy(F.options),U=k({id:A})),(W=_.omit($,p)).original=_.omit(W.original,u),W.classes=W.classes||[],W.currentClass=e.currentClass,(D=h(R={source:hydrogen.get("siteUrl"),style:W,classes:U,colors:I}))&&(hydrogen.get("settings.clipboard.flashCopiedComponent")&&y(),O(D),r=D)),r||f("Can not copy style to clipboard"));break;case"copyConditions":if(r=!1,hydrogen.get("settings.clipboard.enabled"))if(F=v(A)){var D,L=hydrogen.get("options.original.globalconditions",null,F);L?(D=h(R={conditions:L,conditionstype:hydrogen.get("options.original.conditionstype","",F)}))&&(hydrogen.get("settings.clipboard.flashCopiedComponent")&&y(),O(D),r=D):f("There are no conditions to copy")}else f("Can not copy conditions to clipboard");break;case"cut":r=!1,hydrogen.get("settings.clipboard.enabled")&&E("copy")&&(e.removeComponentById(A,M,P.id),r=!0);break;case"paste":if(r=!1,hydrogen.get("settings.clipboard.enabled")){if(!s.clipboard)throw new Error("The clipboard is empty");var R;if((R=function(e){try{var t=decodeURIComponent(escape(atob(e)));return JSON.parse(t)}catch(e){console.error(e)}return!1}(s.clipboard)).constructor!==Object)throw new Error("Invalid clipboard contents");if("object"==typeof R.component){var B=R.source,F=R.component;if(B&&B!==hydrogen.get("siteUrl")){hydrogen.get("settings.clipboard.processMediaImages")&&function(e){!function e(t){if("ct_image"==t.name){var n=t.options.original;if(n.attachment_url)for(var o in"2"==n.image_type&&(delete n.image_type,n.src=n.attachment_url),n)0==o.indexOf("attachment_")&&delete n[o]}t.children&&t.children.forEach(e)}(e)}(F);var H=hydrogen.get("settings.clipboard.colorSet","Copied Colors"),N=hydrogen.get("settings.clipboard.folder","Copied Classes"),U=R.classes;T(I=R.colors,F,U,H),w(U,N)}var z={id:0,depth:0,name:"root",children:[]};Array.isArray(F)?z.children=F:z.children.push(F),t.showLoadingOverlay(),setTimeout((function(){e.addReusableChildren(z,null,A),t.hideLoadingOverlay(),hydrogen.get("settings.clipboard.keepActiveComponent")&&e.activateComponent(A,M)})),r=!0}if("object"==typeof R.style){if(!0!==a)throw new Error("Can not apply styles! The selected element is invalid");if(F=v(A)){B=R.source;var W,$=F.options,K=(W=R.style).currentClass;B&&B!==hydrogen.get("siteUrl")&&(H=hydrogen.get("settings.clipboard.colorSet","Copied Colors"),N=hydrogen.get("settings.clipboard.folder","Copied Classes"),U=R.classes,T(I=R.colors,W,U,H),w(U,N)),_.extend(W.original,_.pick($.original,u)),_.extend(W,_.pick($,p)),delete W.currentClass,F.options=W,e.component.options[A]=_.pick(e.component.options[A],p),e.componentsClasses[A]=W.classes;var J=A;"ct_span"==M&&(J=P.id),e.rebuildDOM(J),K?e.setCurrentClass(K):e.switchEditToId(!0),e.adjustResizeBox(),r=!0}}if("object"==typeof R.conditions){if(!0!==a)throw new Error("Can not apply conditions! The selected element is invalid");(F=v(A))&&(e.setOptionModel("globalconditions",R.conditions,A,M),e.setOptionModel("conditionstype",R.conditionstype,A,M),r=!0)}}break;case"moveUp":if((Z=v(P.id).children)&&Z.length>1){var q=0;if(Z.forEach((function(e,t){e.id==A&&(q=t)})),q>0){var G=Z[q];Z.splice(q,1),Z.splice(--q,0,G),e.rebuildDOM(P.id),"1"===i&&(e.updateDOMTreeNavigator(P.id),e.highlightDOMNode(A))}}break;case"moveDown":var Z;if((Z=v(P.id).children)&&Z.length>1){q=0;var V=Z.length-1;Z.forEach((function(e,t){e.id==A&&(q=t)})),q<V&&(G=Z[q],Z.splice(q,1),Z.splice(++q,0,G),e.rebuildDOM(P.id),"1"===i&&(e.updateDOMTreeNavigator(P.id),e.highlightDOMNode(A)))}break;case"rename":var X=($=e.component.options[A]).nicename||"";(X=prompt("Enter the new element name",X))?(X=X.replace(/["']+/g,"").trim())?($.nicename=X,e.updateFriendlyName(A)):f("Invalid name given!"):null!==X&&f("Name can not be empty!");break;case"changeId":var Q=($=e.component.options[A]).selector||"";(Q=prompt("Enter the new element id",Q))?(Q=Q.replace(/[^\w\-_]+/g,"").trim())?($.selector=Q,e.setOption(A,M,"selector")):f("Invalid ID given!"):null!==Q&&f("ID can not be empty!");break;case"showConditions":t.showConditionsMenu=!1,t.dialogForms.ifCondition=!0,t.showDialogWindow(),b(t);break;case"clearConditions":e.clearConditions();break;case"componentBrowser":t.switchActionTab("componentBrowser"),setTimeout((function(){t.resetComponentsSearch()}));break;case"addComponent":n.length&&e.addComponent.apply(null,n);break;case"switchAdvancedTab":n.length&&(t.showAllStylesFunc(),t.styleTabAdvance=!0,n.unshift("advanced"),t.switchTab.apply(null,n),b(t));break;case"switchCodeBlockTabs":r=!1,t.isActiveName("ct_code_block")&&!t.isShowTab("advanced","code-mixed")&&(t.isCodeEditorFocused()&&m(),t.isShowTab("advanced","code-php")?t.switchTab("advanced","code-css"):t.isShowTab("advanced","code-css")?t.switchTab("advanced","code-js"):(t.isShowTab("advanced","code-js")||(t.showAllStylesFunc(),t.styleTabAdvance=!0),t.switchTab("advanced","code-php")),r=!0,b(t));break;case"applyCode":t.isShowTab("advanced","code-php")?e.applyCodeBlockPHP():t.isShowTab("advanced","code-css")?e.applyCodeBlockCSS():t.isShowTab("advanced","code-js")?e.applyCodeBlockJS():t.isShowTab("advanced","custom-js")?e.applyComponentJS():t.isShowTab("advanced","custom-css")?e.applyComponentCSS():r=!1;break;case"toggleLeftSidebar":var Y=t.showLeftSidebar;"boolean"==typeof Y&&(Y?t.doHideLeftSidebar(!0):t.doShowLeftSidebar(!0));break;case"toggleSettingsPanel":t.toggleSettingsPanel();break;case"switchTab":n.length&&t.switchTab.apply(null,n);break;case"switchSettingsTab":n.length&&(n.unshift("settings"),t.switchTab.apply(null,n),t.toggleSettingsPanel(!0));break;case"switchSettingsChildTab":n.length&&(n.unshift("settings"),t.tabs.settings=[],t.switchChildTab.apply(null,n),t.toggleSettingsPanel(!0));break;case"setMedia":if(n.length){var ee=n[0],te=e.getCurrentMedia();if("number"==typeof ee){var ne=Object.keys(iframeScope.mediaList);if(!((q=ne.indexOf(te)-ee)>=0&&q<ne.length))break;ee=ne[q]}else if(te==ee)break;e.setCurrentMedia(ee,!0,e.isEditing("class"))}break;case"duplicate":e.duplicateComponent(A,M,P.id);break;case"saveReusable":e.saveReusable(A);break;case"saveBlock":e.saveReusable(A,!0);break;case"wrap":e.wrapComponentWith("ct_div_block",A,P.id);break;case"wrapLink":r=!1,S(M,P.name)&&(e.wrapComponentWith("ct_link",A,P.id),r=!0);break;case"delete":e.removeComponentWithUndo(A,M,P.id);break;case"activateParent":"number"==typeof P.id&&(P.id>1e5&&(P.id=0,P.name="root"),e.activateComponent(P.id,P.name));break;case"editContent":r=!1;var oe=e.getActiveComponent();oe&&oe.get(0).hasAttribute("contenteditable")&&(t.enableContentEdit(oe),r=!0);break;case"switchTextComponent":"ct_text_block"!=M&&"oxy_rich_text"!=M||(M="ct_text_block"==M?"oxy_rich_text":"ct_text_block",c.name=M,(F=v(A)).name=M,e.rebuildDOM(A),e.updateBreadcrumbs(A));break;case"undo":e.canUndo&&e.undo();break;case"redo":e.canRedo&&e.redo();break;case"savePage":t.isCodeEditorFocused()?m():E("applyCode"),e.savePage();break;case"openBackend":(ae=g("#oxygen-topbar .oxygen-back-to-wp-menu a").first().prop("href"))&&window.open(ae,"_blank");break;case"openFrontend":var ae;q=e.ajaxVar.ctTemplate?2:1,(ae=g("#oxygen-topbar .oxygen-back-to-wp-menu a").eq(q).prop("href"))&&window.open(ae,"_blank");break;default:r=!1}return b(e),r}if(e.hydroScope=s,t.hydroScope=s,hydrogen.get("settings.contextMenu.enabled")&&(document.addEventListener("click",(function(){t._hpHideFrameMenu()})),window.addEventListener("scroll",(function(){t._hpHideFrameMenu()})),document.addEventListener("contextmenu",(function(e){if(e.target.closest(".ct-component[component-id]")||e.target.closest("#oxygen-resize-box")){var n=e.clientX+1,o=e.clientY+1;t._hpShowFrameMenu(n,o)&&(e.preventDefault(),e.stopImmediatePropagation())}}),!0)),hydrogen.get("settings.clipboard.enabled")){function O(e){if(e){s.clipboard=e;var t=document.getElementById("hydrogen-clipboard-input");return t.value=e,t.focus(),t.select(),document.execCommand("copy"),setTimeout((function(){t.value="",t.setSelectionRange(0,0),t.blur()})),!0}return!1}function A(e){if(!1!==x()){try{s.clipboard=e.originalEvent.clipboardData.getData("Text").trim(),E("paste")}catch(e){console.error(e),f("Failed to process the clipboard contents<br/>"+e)}e.stopPropagation(),e.preventDefault()}}navigator.permissions&&navigator.clipboard&&navigator.permissions.query({name:"clipboard-read"}).then((function(e){e.onchange=function(){s.canReadClipboard="denied"!==this.state},e.onchange()})).catch((function(){console.warn("Clipboard API is not supported in this browser")})),a.on("paste","[contenteditable]",(function(e){this.isContentEditable||(e.stopImmediatePropagation(),A(e))})),n.on("paste",A),s.pasteHandler=A}if(hydrogen.get("settings.shortcuts.enabled")){var M=[];function P(e){var t=[];return e.key&&(e.ctrl&&t.push("ctrl"),e.alt&&t.push("alt"),e.shift&&t.push("shift"),t.push(e.key.toLowerCase())),t.join("+")}function j(e){var n=!1;if(0==e.originalEvent.repeat){var o=P({ctrl:e.ctrlKey||e.metaKey,alt:e.altKey,shift:e.shiftKey,key:e.key});if(o){var a=_.findWhere(M,{shortcut:o});a&&a.arguments.length>0&&function(e,n){if(0==d.includes(n)){var o=e.target;if(o&&(o.isContentEditable||["INPUT","TEXTAREA"].includes(o.nodeName)))return!1;if(t.isActiveActionTab("contentEditing"))return!1}return!0}(e,a.arguments[0])&&(n=E.apply(this,a.arguments))}}n&&(e.stopImmediatePropagation(),e.preventDefault())}!function(){var e=hydrogen.get("settings.shortcuts.hotkeys");if("object"==typeof e){var t=!1,o=["arrowleft","arrowright"];_.each(e,(function(e,n){e.key&&e.arguments&&(M.push({id:n,shortcut:P(e),arguments:_.values(e.arguments)}),0==t&&o.includes(e.key)&&(t=!0))})),t&&n.on("keyup",(function(e){if(37==e.which||39==e.which)return!1}))}}(),n.off("keydown"),o.off("keydown"),n.on("keydown",j),o.on("keydown",j),s.shortcutHandler=j}hydrogen.get("settings.disableEditLocking.enabled")&&(e.setPostEditLockTransient=function(){}),hydrogen.get("settings.conditionsEnhancer.enabled")&&(e.clearConditions=function(){var n=c.id,o=c.name;e.setOptionModel("conditionstype",void 0,n,o,!0),e.setOptionModel("globalconditions",void 0,n,o,!0),t.evalGlobalConditions(),t.evalGlobalConditionsInList()}),hydrogen.get("settings.advancedStylesReset.enabled")&&(jQuery.extend(!0,e.optionsHierarchy,{background:{gradient:["gradient"]},"background-gradient":{gradient:["gradient"]},"custom-css":{"custom-css":["custom-css"]},"custom-js":{"custom-js":["custom-js"]}}),e.clearTabOptions=function(t,n){t.stopPropagation(),t.preventDefault();var o=e.component.active.id,a=e.component.active.name,i=e.component.options,c=e.optionsHierarchy[n];"object"==typeof c&&_.each(c,(function(t){_.each(t,(function(t){i[o]&&i[o].model[t]&&(e.setOptionModel(t,void 0,o,a),!e.isEditing("id")||e.isEditing("media")||e.isEditing("state")||(i[o].id[t]=void 0))}))}))}),hydrogen.get("settings.dynamicClasses.enabled")&&(e.optionsHierarchy&&(e.optionsHierarchy["dynamic-classes"]={"dynamic-classes":["dynamic-classes"]}),e.addDynamicClass=function(){var t="dynamic-classes",n=e.getOption(t);Array.isArray(n)||(n=[]),n.push({value:"",notes:"",sanitize:!1}),e.setOptionModel(t,n)},e.removeDynamicClass=function(t,n){var o="dynamic-classes",a=e.getOption(o);a.splice(n,1),e.setOptionModel(o,a)},e.insertShortcodeToDynamicClass=function(t,n){dynamicClass="dyndata_"+btoa(unescape(encodeURIComponent(t))),e.setOptionModel(n,dynamicClass)}),hydrogen.get("settings.classLock.enabled")&&(e.isClassLocked=function(t){return(t=t||e.currentClass)&&hydrogen.get(t+".locked",!1,e.classes)},e.lockClass=function(t,n){e.classes[t].locked=!0,t==e.currentClass&&e.switchEditToId(!0),n.stopPropagation()},e.unlockClass=function(t,n){e.classes[t].locked=!1,n.stopPropagation()}),hydrogen.get("settings.preserveAdvancedTabs.enabled")&&function(){var n=hydrogen.get("settings.preserveAdvancedTabs.requireAltKey"),o=e.activateComponent;e.activateComponent=function(e,a,i){var r=c.id===e;"ct_inner_content"==a&&(t.styleTabAdvance=!0),t.saveAdvancedTabState(),o.call(null,e,a,i),e>0&&(r||!n||i&&i.altKey?t.restoreAdvancedTabState():t.clearAdvancedTabState())};var a=e.setCustomSelectorToEdit;e.setCustomSelectorToEdit=function(e){a.call(null,e),e&&(t.styleTabAdvance=!0)}}()}"object"!=typeof hydrogen&&(hydrogen={}),angular.extend(hydrogen,{get:function(e,t,n){var o;return n=n||this,void 0===(o=e.split(".").filter((function(e){return e})).reduce((function(e,t){return e&&e[t]}),n))&&(o=t),o},onFunction:function(e,t,n){var o=setInterval((function(){"function"==typeof e[t]&&(n.call(),clearInterval(o))}),50)}}),CTFrontendBuilder.directive("hydrogenPack",["$parentScope",function(e){return{restrict:"A",link:function(t){window.HydrogenPack=new HydrogenPack(t,e)}}}]),hydrogen.get("settings.classLock.enabled")&&CTFrontendBuilder.directive("oxygenResizeBox",["$compile",function(e){return{restrict:"AE",template:function(e){e.append("<div ng-class=\"{'oxygen-resize-box-class-locked': isClassLocked()}\"></div>")}}}]);